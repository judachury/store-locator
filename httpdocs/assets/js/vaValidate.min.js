/*!
 * vaVallidate v0.2.5
 * Copyright 2016 VanillaActive.
 * v0.2.5 = tel input type added
 */
!function(a){a.fn.vaValidate=function(b){var h,c=a(this),d=[],e=!1,f=1,g=500,i=c.find('[type="submit"]'),j=a.extend({fields:c.find("input, select, textarea"),email:/^([a-zA-Z0-9_.-/+])+@([a-zA-Z0-9_.-])+\.([a-zA-Z])+([a-zA-Z])+/,tel:/^[\d -\(\)+]{8,20}$/,script:/[\<\>]+/,postcode:/^[a-zA-Z0-9]{3,4}$/,file:/^.*\.(jpg|jpeg|png|gif|pdf)$/i,genericMsg:"Please correct the highlighted fields",errorClass:"va-error",successClass:"va-success",ajax:!1,type:"POST",dataType:"",action:"",jqxhr:function(b){return a.ajax({method:j.type,dataType:j.dataType,url:j.action,data:b})},success:function(a){return console.log("success:",a)},error:function(a){return console.log("error:",a.responseText)},always:function(){return m()}},b),k=function(){var a=c.find("ul.va-alertbox");0===a.length&&c.prepend('<ul class="va-alertbox bg-danger hidden"></ul>')},l=function(){h=c.find("ul.va-alertbox")},m=function(){var b;d=[],h.addClass("hidden").html(""),j.fields.each(function(){b=a(this),b.parent("div, label").removeClass(j.errorClass),b.parent("div, label").removeClass(j.successClass)})},n=function(){return result=[],d.map(function(b){-1===a.inArray(b,result)&&result.unshift(b)}),result},o=function(){var b,a="";d.push(j.genericMsg),b=n(),b.map(function(b){a+="<li>"+b+"</li>"}),b.length>0?h.removeClass("hidden"):h.addClass("hidden"),h.append(a)},p=function(a){var b=j.errorClass;if(s("script",a.value))return b;switch(a.type){case"text":a.value.length>=a.min&&(b=j.successClass);break;case"postcode":s(a.type,a.value)&&a.value.length>=a.min&&(b=j.successClass);break;case"email":s(a.type,a.value)&&(b=j.successClass);break;case"checkbox":a.value&&(b=j.successClass);break;case"select":a.value.length>0&&(b=j.successClass);break;case"textarea":a.value.length>=a.min&&a.value.length<=a.max&&(b=j.successClass);break;case"file":s(a.type,a.value)&&(b=j.successClass);break;case"tel":s(a.type,a.value)&&(b=j.successClass)}return b!==j.errorClass&&a.mirrorTo&&a.mirrorTo!==a.value&&(b=j.errorClass,d.push(a.messages.mirror)),b},q=function(a,b,c,d){var e=a.data(b);return e?c:d},r=function(a,b){var c;return"string"==typeof a&&(c=a.trim().replace(b,"")),c},s=function(a,b){return j[a].test(b)},t=function(a){var b=a.attr("type")?a.attr("type"):a.data("va-textarea")?"textarea":"select",d=a.attr("name");return inputType=q(a,"va-postcode-strict",d,b),inputPlh=function(){return"select"===b?q(a,"va-select-placeholder",a.find("option").first().val(),""):a.attr("placeholder")},getValue=function(){switch(b){case"select":return r(a.find("option:selected").val(),inputPlh());case"checkbox":return a.prop("checked");default:return r(a.val(),inputPlh())}},getMirrorValue=function(){var b=a.data("va-mirror-to"),d=q(a,"va-mirror-to",c.find("[name="+b+"]"),!1);return d?r(d.val(),d.attr("placeholder")):!1},{name:d,type:inputType,messages:{required:q(a,"va-msg-required",a.data("va-msg-required"),""),optional:q(a,"va-msg-optional",a.data("va-msg-optional"),""),pattern:q(a,"va-msg-pattern",a.data("va-msg-pattern"),""),mirror:q(a,"va-msg-mirror",a.data("va-msg-mirror"),"")},value:getValue(),mirrorTo:getMirrorValue(),pattern:q(a,"va-custom-pattern",a.data("va-custom-pattern"),""),min:q(a,"va-min",a.data("va-min"),f),max:q(a,"va-max",a.data("va-max"),g)}},u=function(){var f,b=!1,c={},d={},e={},g=function(){var f=a(this),g=t(f);f.data("va-required")?(validation=p(g),f.parent("div, label").addClass(validation),"file"===g.type&&f.parent().parent().parent("div").addClass(validation),validation===j.errorClass&&(b=!0)):f.data("va-optional")&&g.value.length>0&&(validation=p(g),f.parent("div, label").addClass(validation),validation===j.errorClass&&(b=!0)),f.data("va-code")?d[f.data("va-code")]=d[f.data("va-code")]?d[f.data("va-code")]+g.value:g.value:f.data("va-dob")?e[f.data("va-dob")]=g.value:c[g.name]=g.value};j.fields.each(g);for(value in d)c[value]=d[value];e.hasOwnProperty("day")&&e.hasOwnProperty("month")&&e.hasOwnProperty("year")&&(c.dob=e.day+" "+e.month+" "+e.day,c.dob=c.dob.trim()),b?o():j.ajax?(f=j.jqxhr(c),f.done(j.success),f.fail(j.error)):j.success(c)},v=function(a){a.preventDefault(),e||(e=!0,m(),u(),e=!1)};k(),l(),i.on("click",v)}}(jQuery);